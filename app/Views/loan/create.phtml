<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>New Loan</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">

<div class="container my-5">

    <h2 class="fw-bold mb-4">Nouvel emprunt</h2>

    <?php if (!empty($_SESSION['flash'])): ?>
        <div class="alert alert-warning"><?= $_SESSION['flash'] ?></div>
        <?php unset($_SESSION['flash']); ?>
    <?php endif; ?>

    <form method="post" action="index.php?controller=loan&action=store" class="card p-4 shadow-sm bg-white">

        <!-- EQUIPMENT SELECTION -->
        <div class="mb-3">
            <label for="equipment_id" class="form-label fw-semibold">Matériel</label>
            <select name="equipment_id" id="equipment_id" class="form-select" required>
                <option value="">-- Choix du matériel --</option>
                <?php foreach ($equipments as $eq): ?>
                    <option value="<?= $eq->id ?>">
                        <?= htmlspecialchars($eq->name) ?> (<?= htmlspecialchars($eq->serial_number) ?>)
                    </option>
                <?php endforeach; ?>
            </select>
        </div>

        <!-- GRANTEE NAME -->
        <div class="mb-3">
            <label for="grantee" class="form-label fw-semibold">Bénéficiaire</label>
            <input type="text" name="grantee" id="grantee" class="form-control" required>
        </div>

        <!-- GRANTEE TYPE -->
        <div class="mb-3">
            <label for="grantee_type" class="form-label fw-semibold">Type bénéficiaire</label>
            <select name="grantee_type" id="grantee_type" class="form-select" required>
                <option value="">-- Choix du type --</option>
                <option value="employe">Employé(e)</option>
                <option value="occupant">Occupant(e)</option>
                <option value="externe">Partenaire externe</option>
            </select>
        </div>

        <!-- LOAN DATES -->
        <div class="mb-3">
            <label for="return_at" class="form-label fw-semibold">Date de retour espéré</label>
            <input type="date" name="return_at" id="return_at" class="form-control" required>
        </div>


        <!-- COMMENT -->
        <div class="mb-3">
            <label for="comment" class="form-label fw-semibold">Commentaire</label>
            <textarea name="comment" id="comment" rows="3" class="form-control"></textarea>
        </div>

        <div class="d-flex justify-content-between mt-4">
            <a href="index.php?controller=equipment&action=dashboard" class="btn btn-outline-secondary">
                Retour
            </a>
            <button type="submit" class="btn btn-primary">
                Valider
            </button>
        </div>

    </form>
</div>

</body>
</html>
